{"componentChunkName":"component---src-templates-post-tsx","path":"/OOPWithJavascript_4/","result":{"data":{"markdownRemark":{"html":"<h1 id=\"todo\" style=\"position:relative;\"><a href=\"#todo\" aria-label=\"todo permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>TODO</h1>\n<p>[ ] class diagram 그리기</p>\n<p>\b객체지향 프로그램이란 처음에 이루고자하는 목표에서부터 덩어리진 것을 차근차근 분리하고 깍아내는 과정\n어떻게 깍을지 기준정하는 방법은? \"역할\"\n덩어리진 코드를 클래스로 나누려고 할때 \"역할, 기준\"이 필요하다. 객체지향에서 \"역할, 기준\"은 역할, 책임 모델이라고 하는 것입니다.</p>\n<p>\"역할, 책임\"은 비슷해보이지만 동전의 양면을 가지고 있다.\n책임을 가지고 있다는건? 그 책임에 대한 권한도 가지고 있다.\n권한이 있다는건? 권한에 대한 책임이 있다.\n그래서 역할을 정의하려면 어떤 권한을 주입 받고, 그 권한으로 부터 무슨 일을 수행하는 권한을 양도 받기위해서는 어떤 책임까지 가져야 하는지 한번에 정의해야 한다. </p>\n<h1 id=\"1-isp\" style=\"position:relative;\"><a href=\"#1-isp\" aria-label=\"1 isp permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>1. ISP</h1>\n<blockquote>\n<p>SOLID 원칙 중 하나\nInterface Segregation\n인터페이스 분리하는 원칙(이 원칙으로 덩어리진 코드들을 나눌 수 있다.)</p>\n</blockquote>\n<ul>\n<li>\n<p>한코드에 여러개가 들어가 있으면 이것들을 인터페이스별로 잘라서 분리 할 수 있다. </p>\n<ul>\n<li>역기서 인터페이스는 \b역할을 얘기합니다.(실제 물리적인 인터페이스를 말하는 것이 아님)</li>\n</ul>\n</li>\n<li>객체지향에서 코드 분리할때 가장 기본적인 방법이다. </li>\n<li>ViewModel을 이 법칙을 적용해보려고 한다. </li>\n</ul>\n<h2 id=\"11-옵저버-서브젝트-파일-리팩토링-하기\" style=\"position:relative;\"><a href=\"#11-%EC%98%B5%EC%A0%80%EB%B2%84-%EC%84%9C%EB%B8%8C%EC%A0%9D%ED%8A%B8-%ED%8C%8C%EC%9D%BC-%EB%A6%AC%ED%8C%A9%ED%86%A0%EB%A7%81-%ED%95%98%EA%B8%B0\" aria-label=\"11 옵저버 서브젝트 파일 리팩토링 하기 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>1.1 옵저버 서브젝트 파일 리팩토링 하기</h2>\n<ul>\n<li>\n<p>pdf4, 5, 6</p>\n<ul>\n<li>뷰모델에는 어울리지 않다고 보인다 </li>\n<li>\n<p>옵저버패턴에 서브젝트 역할 -> 분리하자!</p>\n<ul>\n<li>메소드 코드를 분리할때 변수도 같이 이동해야한다.</li>\n<li>메소드 설계시 의존하고 있는 필드를 역할별로 필드를 같이 쓰지 않게 잘 설계해야 한다.  </li>\n</ul>\n</li>\n</ul>\n</li>\n<li>\n<p>pdf7</p>\n<ul>\n<li>SOLID원칙 보고 어떻게 뷰모델에서 옵저버 서브젝트 파일을 빼낼까 고민 중...</li>\n<li>상속모델을 사용할 것이다 우측 하단과 비슷한 모델을 사용</li>\n<li>서브젝트모델 === 인터페이스A/<br>\n뷰모델 === 객체 === 서브젝트모델을 상속받은 모델</li>\n</ul>\n</li>\n<li>\n<p>pdf8, 9</p>\n<ul>\n<li>\n<p>설명1 상속</p>\n<ul>\n<li>\n<p>3강에서 ViewModel은 ViewModelListener을 상속는데 여기서 ViewModelSubject에 ViewModelListener을 상속 받는 이유는 뭘까? </p>\n<ul>\n<li>\n<p>Javascript는 다중 상속이 안돼서 어쩔 수 없이 ViewModelSubject가 ViewModelListener을 상속받고 ViewModel이 ViewModelSubject를 상속받는다 </p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">3장 ViewModel -&gt;                     ViewModelListener\n4장 ViewModel -&gt; ViewModelSubject -&gt; ViewModelListener</code></pre></div>\n</li>\n</ul>\n</li>\n</ul>\n</li>\n<li>\n<p>설명2 add, clear추가 </p>\n<ul>\n<li>\n<h1 id=\"isupdated---info\" style=\"position:relative;\"><a href=\"#isupdated---info\" aria-label=\"isupdated   info permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>isUpdated -> #info</h1>\n</li>\n<li>\n<h1 id=\"info는-부모에-있는-private-속성이다-자식이-못건드리기-때문에-부모에-속성-info-private-속성을-제거-추가할때는-부모쪽에서-서비스를-내려줘야한다-그래서-내가-viewmodel-info를-변경하고-싶을때는-부모쪽-메소드에서-viewmodel-value를-직접-넘겨-viewmodel를-직접-넘겨서-viewmodel-value를-부모인-서브젝트가-직접-추가하도록-위임해서-동작하게-해야한다-clear도-부모에게-직접-요청해서-추가해야-한다\" style=\"position:relative;\"><a href=\"#info%EB%8A%94-%EB%B6%80%EB%AA%A8%EC%97%90-%EC%9E%88%EB%8A%94-private-%EC%86%8D%EC%84%B1%EC%9D%B4%EB%8B%A4-%EC%9E%90%EC%8B%9D%EC%9D%B4-%EB%AA%BB%EA%B1%B4%EB%93%9C%EB%A6%AC%EA%B8%B0-%EB%95%8C%EB%AC%B8%EC%97%90-%EB%B6%80%EB%AA%A8%EC%97%90-%EC%86%8D%EC%84%B1-info-private-%EC%86%8D%EC%84%B1%EC%9D%84-%EC%A0%9C%EA%B1%B0-%EC%B6%94%EA%B0%80%ED%95%A0%EB%95%8C%EB%8A%94-%EB%B6%80%EB%AA%A8%EC%AA%BD%EC%97%90%EC%84%9C-%EC%84%9C%EB%B9%84%EC%8A%A4%EB%A5%BC-%EB%82%B4%EB%A0%A4%EC%A4%98%EC%95%BC%ED%95%9C%EB%8B%A4-%EA%B7%B8%EB%9E%98%EC%84%9C-%EB%82%B4%EA%B0%80-viewmodel-info%EB%A5%BC-%EB%B3%80%EA%B2%BD%ED%95%98%EA%B3%A0-%EC%8B%B6%EC%9D%84%EB%95%8C%EB%8A%94-%EB%B6%80%EB%AA%A8%EC%AA%BD-%EB%A9%94%EC%86%8C%EB%93%9C%EC%97%90%EC%84%9C-viewmodel-value%EB%A5%BC-%EC%A7%81%EC%A0%91-%EB%84%98%EA%B2%A8-viewmodel%EB%A5%BC-%EC%A7%81%EC%A0%91-%EB%84%98%EA%B2%A8%EC%84%9C-viewmodel-value%EB%A5%BC-%EB%B6%80%EB%AA%A8%EC%9D%B8-%EC%84%9C%EB%B8%8C%EC%A0%9D%ED%8A%B8%EA%B0%80-%EC%A7%81%EC%A0%91-%EC%B6%94%EA%B0%80%ED%95%98%EB%8F%84%EB%A1%9D-%EC%9C%84%EC%9E%84%ED%95%B4%EC%84%9C-%EB%8F%99%EC%9E%91%ED%95%98%EA%B2%8C-%ED%95%B4%EC%95%BC%ED%95%9C%EB%8B%A4-clear%EB%8F%84-%EB%B6%80%EB%AA%A8%EC%97%90%EA%B2%8C-%EC%A7%81%EC%A0%91-%EC%9A%94%EC%B2%AD%ED%95%B4%EC%84%9C-%EC%B6%94%EA%B0%80%ED%95%B4%EC%95%BC-%ED%95%9C%EB%8B%A4\" aria-label=\"info는 부모에 있는 private 속성이다 자식이 못건드리기 때문에 부모에 속성 info private 속성을 제거 추가할때는 부모쪽에서 서비스를 내려줘야한다 그래서 내가 viewmodel info를 변경하고 싶을때는 부모쪽 메소드에서 viewmodel value를 직접 넘겨 viewmodel를 직접 넘겨서 viewmodel value를 부모인 서브젝트가 직접 추가하도록 위임해서 동작하게 해야한다 clear도 부모에게 직접 요청해서 추가해야 한다 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>info는 부모에 있는 private 속성이다. 자식이 못건드리기 때문에 부모에 속성 #info private 속성을 제거, 추가할때는 부모쪽에서 서비스를 내려줘야한다. 그래서 내가 ViewModel #info를 변경하고 싶을때는 부모쪽 메소드에서 ViewModel Value를 직접 넘겨 ViewModel를 직접 넘겨서 ViewModel Value를 부모인 서브젝트가 직접 추가하도록 위임해서 동작하게 해야한다. clear도 부모에게 직접 요청해서 추가해야 한다.</h1>\n</li>\n</ul>\n</li>\n<li>\n<p>설명3 watch</p>\n<ul>\n<li>이전에는 addListener를 하고 ViewModel이 생성되는 시점에 바로 전체 서브젝트 리스트에 등록했다. </li>\n<li>지금은 Listener가 들어온순간 서브젝트를 watch로 보낼 것이다.\n뷰모델 생성했다고 바로 requestAnimationFrame 넣어서 감시할 필요가 없다.\nListener가 하나라도 생겼을때 감시하면 된다!(\b뷰모델을 감사하는 사람이 없어 변화를 추적할 필요가 없다.)</li>\n</ul>\n</li>\n<li>\n<p>설명4 unwatch</p>\n<ul>\n<li>\n<p>뮤보델은 구독하는 listener가 없을때 unwatch를 하자!</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token comment\">//설명1</span>\n<span class=\"token keyword\">const</span> ViewModelSubject <span class=\"token operator\">=</span> <span class=\"token keyword\">class</span> <span class=\"token class-name\">extends</span> ViewModelListener<span class=\"token punctuation\">{</span> \n#info <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">Set</span><span class=\"token punctuation\">;</span> #listeners <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">Set</span><span class=\"token punctuation\">;</span>\n<span class=\"token comment\">//설명2 add, clear</span>\n<span class=\"token function\">add</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">v<span class=\"token punctuation\">,</span> _<span class=\"token operator\">=</span><span class=\"token function\">type</span><span class=\"token punctuation\">(</span>v<span class=\"token punctuation\">,</span> ViewModelValue<span class=\"token punctuation\">)</span></span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">{</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>#info<span class=\"token punctuation\">.</span><span class=\"token function\">add</span><span class=\"token punctuation\">(</span>v<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span><span class=\"token punctuation\">}</span> \n<span class=\"token function\">clear</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">{</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>#info<span class=\"token punctuation\">.</span><span class=\"token function\">clear</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span><span class=\"token punctuation\">}</span>\n<span class=\"token function\">addListener</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">v<span class=\"token punctuation\">,</span> _<span class=\"token operator\">=</span><span class=\"token function\">type</span><span class=\"token punctuation\">(</span>v<span class=\"token punctuation\">,</span> ViewModelListener<span class=\"token punctuation\">)</span></span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">{</span> \n<span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>#listeners<span class=\"token punctuation\">.</span><span class=\"token function\">add</span><span class=\"token punctuation\">(</span>v<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> \n<span class=\"token comment\">//설명3</span>\nViewModelSubject<span class=\"token punctuation\">.</span><span class=\"token function\">watch</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n<span class=\"token function\">removeListener</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">v<span class=\"token punctuation\">,</span> _<span class=\"token operator\">=</span><span class=\"token function\">type</span><span class=\"token punctuation\">(</span>v<span class=\"token punctuation\">,</span> ViewModelListener<span class=\"token punctuation\">)</span></span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">{</span>\n<span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>#listeners<span class=\"token punctuation\">.</span><span class=\"token function\">delete</span><span class=\"token punctuation\">(</span>v<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token comment\">//설명4</span>\n<span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span><span class=\"token operator\">!</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>#listeners<span class=\"token punctuation\">.</span>size<span class=\"token punctuation\">)</span> ViewModelSubject<span class=\"token punctuation\">.</span><span class=\"token function\">unwatch</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> \n<span class=\"token punctuation\">}</span>\n<span class=\"token function\">notify</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">{</span>\n<span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>#listeners<span class=\"token punctuation\">.</span><span class=\"token function\">forEach</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">v</span><span class=\"token operator\">=></span>v<span class=\"token punctuation\">.</span><span class=\"token function\">viewmodelUpdated</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>#info<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span></code></pre></div>\n</li>\n</ul>\n</li>\n</ul>\n</li>\n</ul>\n<h2 id=\"12-notify-리팩토링\" style=\"position:relative;\"><a href=\"#12-notify-%EB%A6%AC%ED%8C%A9%ED%86%A0%EB%A7%81\" aria-label=\"12 notify 리팩토링 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>1.2 notify 리팩토링</h2>\n<ul>\n<li>pdf10\nrequestAnimationFrame에 의해서 subject돌면서 뷰모델에 notify해준다. </li>\n<li>\n<p>pdf11</p>\n<ul>\n<li>notify가 무조건 돈다. </li>\n<li>\n<p>설명1 flag를 통한 Animation 제어</p>\n<ul>\n<li>requsetAnimationFrame를 동작 여부를 결정하는 flag \"#inited\"를 사용하고 있다. </li>\n</ul>\n</li>\n<li>\n<p>설명2, 설명3 flag를 통한 Animation 제어</p>\n<ul>\n<li>리스너가 없는 뷰모델을 여러개 만들어도 requestAnimationFrame은 돌지 않는다. 뷰모델에 리스너를 등록해야지 그 뷰모델을 감시하기 시작하고 리스너를 다 빼서 하나도 없다면 requestAnimation도 멈추게 된다. </li>\n<li>기존 notify함수에 this.#subjects.add(vm); 코드로 subject를 관리했는데 이렇게 하면 외부에서는 notify에 #subject에 add한다는 사실을 모른다. 그래서 외부에서 알 수 있도록 watch, unwatch함수 #subject.add, #subject.delete를 통해서 관리해주고 있다. </li>\n</ul>\n</li>\n<li>\n<p>추가 정보: 플래그변수, 싱글스레드, 멀티스레드 </p>\n<ul>\n<li>Javascript는 싱글스레드이기 때문에 플래그 변수로 제어하기 쉽다. 다른 언어는 멀시스레드이기 때문에 플래그 제어가 안된다. </li>\n<li>플래그 기만에 효율적인 알고리즘짜는것을 계속해서 연습해야 한다. </li>\n<li>멀티 스레드에서 작업할때는 플래그 기만이 아니라 멀티스레드에서 안정성을 확보하고 효율성을 확보하는 패턴을 배워야한다.</li>\n</ul>\n</li>\n<li>\n<p>추가 정보: static method</p>\n<ul>\n<li>notify static private method로 설정해야하는데 Javascript에는 static method를 지원하지 않아서 공개적으로 되어 있다. \u001f</li>\n<li>watch, unwatch도 외부에 공개 되어야 하지만 public은 아니다. 내부 Framework안에서 돌기 때문에 </li>\n</ul>\n</li>\n</ul>\n</li>\n</ul>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token keyword\">const</span> ViewModelSubject <span class=\"token operator\">=</span> <span class=\"token keyword\">class</span> <span class=\"token class-name\">extends</span> ViewModelListener<span class=\"token punctuation\">{</span> \n\n<span class=\"token operator\">...</span><span class=\"token comment\">//위 코드 참고</span>\n\n    <span class=\"token keyword\">static</span> #subjects <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">Set</span><span class=\"token punctuation\">;</span> <span class=\"token keyword\">static</span> #inited <span class=\"token operator\">=</span> <span class=\"token boolean\">false</span><span class=\"token punctuation\">;</span> \n    <span class=\"token keyword\">static</span> <span class=\"token function\">notify</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">{</span>\n        <span class=\"token keyword\">const</span> <span class=\"token function-variable function\">f</span> <span class=\"token operator\">=</span><span class=\"token parameter\">_</span><span class=\"token operator\">=></span><span class=\"token punctuation\">{</span> \n            <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>#subjects<span class=\"token punctuation\">.</span><span class=\"token function\">forEach</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">v</span><span class=\"token operator\">=></span><span class=\"token punctuation\">{</span>\n                <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span>v<span class=\"token punctuation\">.</span>#info<span class=\"token punctuation\">.</span>size<span class=\"token punctuation\">)</span><span class=\"token punctuation\">{</span> \n                    v<span class=\"token punctuation\">.</span><span class=\"token function\">notify</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n                    v<span class=\"token punctuation\">.</span><span class=\"token function\">clear</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> \n                <span class=\"token punctuation\">}</span>\n            <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n            <span class=\"token comment\">//설명1</span>\n            <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>#inited<span class=\"token punctuation\">)</span> <span class=\"token function\">requestAnimationFrame</span><span class=\"token punctuation\">(</span>f<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> \n        <span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n        <span class=\"token function\">requestAnimationFrame</span><span class=\"token punctuation\">(</span>f<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> \n    <span class=\"token punctuation\">}</span>\n\n    <span class=\"token comment\">//설명2</span>\n    <span class=\"token keyword\">static</span> <span class=\"token function\">watch</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">vm<span class=\"token punctuation\">,</span> _<span class=\"token operator\">=</span><span class=\"token function\">type</span><span class=\"token punctuation\">(</span>vm<span class=\"token punctuation\">,</span> ViewModelListener<span class=\"token punctuation\">)</span></span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">{</span>\n        <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>#subjects<span class=\"token punctuation\">.</span><span class=\"token function\">add</span><span class=\"token punctuation\">(</span>vm<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">//set에 add해도 변화 x</span>\n        <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span><span class=\"token operator\">!</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>#inited<span class=\"token punctuation\">)</span><span class=\"token punctuation\">{</span>\n            <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>#inited <span class=\"token operator\">=</span> <span class=\"token boolean\">true</span><span class=\"token punctuation\">;</span>\n            <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span><span class=\"token function\">notify</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> \n        <span class=\"token punctuation\">}</span>\n    <span class=\"token punctuation\">}</span>\n\n    <span class=\"token comment\">//설명3</span>\n    <span class=\"token keyword\">static</span> <span class=\"token function\">unwatch</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">vm<span class=\"token punctuation\">,</span> _<span class=\"token operator\">=</span><span class=\"token function\">type</span><span class=\"token punctuation\">(</span>vm<span class=\"token punctuation\">,</span> ViewModelListener<span class=\"token punctuation\">)</span></span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">{</span>\n        <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>#subjects<span class=\"token punctuation\">.</span><span class=\"token function\">delete</span><span class=\"token punctuation\">(</span>vm<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span><span class=\"token operator\">!</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>#subjects<span class=\"token punctuation\">.</span>size<span class=\"token punctuation\">)</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>#inited <span class=\"token operator\">=</span> <span class=\"token boolean\">false</span><span class=\"token punctuation\">;</span> \n    <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span>    </code></pre></div>\n<h1 id=\"2-섬세한-권한-조정\" style=\"position:relative;\"><a href=\"#2-%EC%84%AC%EC%84%B8%ED%95%9C-%EA%B6%8C%ED%95%9C-%EC%A1%B0%EC%A0%95\" aria-label=\"2 섬세한 권한 조정 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>2. 섬세한 권한 조정</h1>\n<blockquote>\n<p>위 ISP방법을 통해서 ViewModel이 가벼워 졌는데 이제는 섬세한 권한 조정을 하려고 한다. </p>\n</blockquote>\n<ul>\n<li>\n<p>권한 조정이 필요한 이유 </p>\n<ul>\n<li>권한제어자가 기본적으로 제공되는 언어 java, 코틀린 private, internal, public </li>\n<li>Java의 기본 권한 private, Javascript 기본권한 public</li>\n<li>그래서 생기는 문제는 getter, setter외부에 노출이 되면 코드 조작이 가능해서 문제가 생긴다. </li>\n</ul>\n</li>\n<li>\n<p>설명1 readonly</p>\n<ul>\n<li>외부 공개, 쓰기는 private(public getter, private setter pattern)</li>\n</ul>\n</li>\n<li>\n<p>설명2 Transaction 연산</p>\n<ul>\n<li>\n<p>자바스크립트는 트렌젝션을 따로 지원하지 않기 때문에 함수를 통해서 트렌젝션 연산이라는 것을 알려줘야 한다. </p>\n<ul>\n<li>Transaction이란? 코드가 한번에 일어나야 하는 구간이다.<br>\n그런데 그 구간에서 하나하나 일어나야 하는건지 덩어리로 한번에 일어나는지 아닌지 구별하는 방법이 없다. 그런데 자바스크립트에서는 덩어리로 한번에 일어나게 하는 방법은 \"함수\"를 통해서 한번에 일어나야 할 코드들을 표시할 수 있다. </li>\n</ul>\n</li>\n<li>\n<p>이렇게 setParent 함수로 만든 다른이유는? </p>\n<ul>\n<li>코드로 가져 올때 코드가 아닌 함수로 가지고 오기때문에 '전달인자'를 넘겨줘서 문제 없이 세팅할수 있다. </li>\n<li>함수가 아닌 코드로 클래스에서 있을경우 함수에서 인자로 넘겨주는 변수들이 '지역변수, 클로저'에 설정되어 있기 때문에 문제가 될수있기 때문에   </li>\n</ul>\n</li>\n<li>내부 함수는 \"_\"를 붙이자.    </li>\n<li>이 코드는 parent를 세팅할\u001f때 있어야 하는 코드(기존에는 constructor안 dfineProperty하는 로직에 있었던 코드다.)</li>\n<li>코드에서 꼭 표현해야 할 것! -> \"Transaction\"이다    </li>\n</ul>\n</li>\n<li>\n<p>설명3 update할 객체 세팅 방법 변경 </p>\n<ul>\n<li>\n<p>기존에는 뷰모델 #isUpdated에 직접 Set객체에 add통해 설정했지만 현재는 ViewModelSubject 클래스로 이동해 상속받았기 때문에 부모에게 호출하고 있다.(this.add(...))</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token comment\">//기존</span>\nvm<span class=\"token punctuation\">.</span>#isUpdated<span class=\"token punctuation\">.</span><span class=\"token function\">add</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">new</span> <span class=\"token class-name\">ViewModelValue</span><span class=\"token punctuation\">(</span>vm<span class=\"token punctuation\">.</span>subKey<span class=\"token punctuation\">,</span> category<span class=\"token punctuation\">,</span> k<span class=\"token punctuation\">,</span> v<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n</li>\n</ul>\n</li>\n<li>\n<p>설명4 ViewModel.notify(this); 제거</p>\n<ul>\n<li>\n<p>기존에는 뷰모델이 직접 자신에게 notify를 등록했는데 지금은 하지 않는다. 왜? </p>\n<ul>\n<li>생성시점에 등록 안할거고 addListener할때 lazy하게 등록할 것이기 때문!</li>\n<li>addListener에 lazy하는것도 뷰모델 서브젝트가 알아서 할 것이다. </li>\n</ul>\n</li>\n</ul>\n</li>\n<li>\n<p>설명5 ViewModelListener Class viewmodelUpdated 함수 오버라이딩</p>\n<ul>\n<li>ViewModelListener Class viewmodelUpdated 함수를 ViewModelSubject에서 오버라이딩 하지 않았다.\n그래서 ViewModel에서 오버라이딩 하지 않으면 throw된다.</li>\n<li>이번 강의 ViewModel 상속 관계도<br>\n: ViewModel -> ViewModelSubject -> ViewModelListener</li>\n<li>추가적으로 설명3과 같이 this.#isUpdated.add(v) -> this.add(v)로 코드가 변경됐다.</li>\n</ul>\n</li>\n<li>\n<p>설명6 트렌젝션으로 setParent로 한번에 처리</p>\n<ul>\n<li>기존에는 아래와 같은 코드를 setPraent 함수로 한번에 처리 했습니다.\nv.parent = this; v.subKey = k;, v.addListener(this); </li>\n</ul>\n</li>\n<li>\n<p>추가 설명</p>\n<ul>\n<li>그래서 부모 자식간, 필드 접근 권한, 트렌젝션에 의해 계층 권한이 생기는 경우 직접 변수에 접근한는 이유는 다양하다. </li>\n<li>권한관계라는건 발생하는건 여러가지 인데 물론 직짜 권한때문에 일어나느 경우가 많지만 트렌젝션때문에 일어나는 경우도 비일비재 하다.</li>\n<li>코드를 함수로 빼기위해서 코드를 한번 더 정리하기 때문에 코드 부분이 깔금하게 될 수 있다. </li>\n<li>코드가 길다 싶으면 외부함수, 스태틱함수로 변경하는건 좋은 연습니다.  </li>\n</ul>\n</li>\n</ul>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token keyword\">const</span> ViewModel <span class=\"token operator\">=</span> <span class=\"token keyword\">class</span> <span class=\"token class-name\">extends</span> ViewModelSubject<span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">static</span> <span class=\"token keyword\">get</span><span class=\"token punctuation\">(</span>data<span class=\"token punctuation\">)</span><span class=\"token punctuation\">{</span><span class=\"token keyword\">return</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">ViewModel</span><span class=\"token punctuation\">(</span>data<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span><span class=\"token punctuation\">}</span>\n    styles <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span> attributes <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span> properties <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span> events <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span> \n    \n    <span class=\"token comment\">//설명1 readonly</span>\n    #subKey <span class=\"token operator\">=</span> <span class=\"token string\">\"\"</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">get</span> <span class=\"token function\">subKey</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">{</span><span class=\"token keyword\">return</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>#subKey<span class=\"token punctuation\">;</span><span class=\"token punctuation\">}</span>\n    #parent <span class=\"token operator\">=</span> <span class=\"token keyword\">null</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">get</span> <span class=\"token function\">parent</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">{</span><span class=\"token keyword\">return</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>#parent<span class=\"token punctuation\">;</span><span class=\"token punctuation\">}</span>\n    \n    <span class=\"token comment\">//설명2 [설명6과 관련]Transaction 연산</span>\n    <span class=\"token function\">setParent</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">parent<span class=\"token punctuation\">,</span> subKey</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">{</span>\n        <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>#parent <span class=\"token operator\">=</span> <span class=\"token function\">type</span><span class=\"token punctuation\">(</span>parent<span class=\"token punctuation\">,</span> ViewModel<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>#subKey <span class=\"token operator\">=</span> subKey<span class=\"token punctuation\">;</span>\n        <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span><span class=\"token function\">addListener</span><span class=\"token punctuation\">(</span>parent<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n    \n    <span class=\"token function\">constructor</span><span class=\"token punctuation\">(</span>data<span class=\"token punctuation\">,</span> _<span class=\"token operator\">=</span><span class=\"token function\">type</span><span class=\"token punctuation\">(</span>data<span class=\"token punctuation\">,</span> <span class=\"token string\">\"object\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">{</span> \n        <span class=\"token keyword\">super</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        Object<span class=\"token punctuation\">.</span><span class=\"token function\">entries</span><span class=\"token punctuation\">(</span>data<span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">forEach</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token parameter\"><span class=\"token punctuation\">[</span>cat<span class=\"token punctuation\">,</span> obj<span class=\"token punctuation\">]</span></span><span class=\"token punctuation\">)</span><span class=\"token operator\">=></span><span class=\"token punctuation\">{</span> \n            <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"styles,attributes,properties\"</span><span class=\"token punctuation\">.</span><span class=\"token function\">includes</span><span class=\"token punctuation\">(</span>cat<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n                <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token operator\">!</span>obj <span class=\"token operator\">||</span> <span class=\"token keyword\">typeof</span> obj <span class=\"token operator\">!=</span> <span class=\"token string\">\"object\"</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">throw</span> <span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token string\">invalid object cat:</span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>cat<span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token string\">, obj:</span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>obj<span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token template-punctuation string\">`</span></span><span class=\"token punctuation\">;</span> \n                <span class=\"token keyword\">this</span><span class=\"token punctuation\">[</span>cat<span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> Object<span class=\"token punctuation\">.</span><span class=\"token function\">defineProperties</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span> Object<span class=\"token punctuation\">.</span><span class=\"token function\">entries</span><span class=\"token punctuation\">(</span>obj<span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">reduce</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">r<span class=\"token punctuation\">,</span> <span class=\"token punctuation\">[</span>k<span class=\"token punctuation\">,</span> v<span class=\"token punctuation\">]</span></span><span class=\"token punctuation\">)</span><span class=\"token operator\">=></span><span class=\"token punctuation\">{</span>\n                    r<span class=\"token punctuation\">[</span>k<span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span> \n                        enumerable<span class=\"token operator\">:</span><span class=\"token boolean\">true</span><span class=\"token punctuation\">,</span> <span class=\"token function-variable function\">get</span><span class=\"token operator\">:</span><span class=\"token parameter\">_</span><span class=\"token operator\">=></span>v<span class=\"token punctuation\">,</span> <span class=\"token function-variable function\">set</span><span class=\"token operator\">:</span><span class=\"token parameter\">newV</span><span class=\"token operator\">=></span><span class=\"token punctuation\">{</span>\n                        v <span class=\"token operator\">=</span> newV<span class=\"token punctuation\">;</span>\n                        <span class=\"token comment\">//설명3 update할 객체 세팅 방법 변경</span>\n                        <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span><span class=\"token function\">add</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">new</span> <span class=\"token class-name\">ViewModelValue</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>#subKey<span class=\"token punctuation\">,</span> cat<span class=\"token punctuation\">,</span> k<span class=\"token punctuation\">,</span> v<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> <span class=\"token punctuation\">}</span>\n                    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n                    <span class=\"token keyword\">return</span> r<span class=\"token punctuation\">;</span> \n                <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">{</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n            <span class=\"token punctuation\">}</span><span class=\"token keyword\">else</span><span class=\"token punctuation\">{</span>\n                Object<span class=\"token punctuation\">.</span><span class=\"token function\">defineProperties</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">{</span> \n                    <span class=\"token punctuation\">[</span>cat<span class=\"token punctuation\">]</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\n                        enumerable<span class=\"token operator\">:</span> <span class=\"token boolean\">true</span><span class=\"token punctuation\">,</span>\n                        <span class=\"token function-variable function\">get</span><span class=\"token operator\">:</span> <span class=\"token parameter\">_</span> <span class=\"token operator\">=></span> obj<span class=\"token punctuation\">,</span>\n                        <span class=\"token function-variable function\">set</span><span class=\"token operator\">:</span> <span class=\"token parameter\">newV</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n                            obj <span class=\"token operator\">=</span> newV<span class=\"token punctuation\">;</span>\n                            <span class=\"token comment\">//설명3 update할 객체 세팅 방법 변경</span>\n                            <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span><span class=\"token function\">add</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">new</span> <span class=\"token class-name\">ViewModelValue</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>#subKey<span class=\"token punctuation\">,</span> <span class=\"token string\">\"root\"</span><span class=\"token punctuation\">,</span> cat<span class=\"token punctuation\">,</span> obj<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> \n                        <span class=\"token punctuation\">}</span>\n                    <span class=\"token punctuation\">}</span> \n                <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n                <span class=\"token comment\">//설명6 [설명2와 관련]트렌젝션으로 setParent로 한번에 처리</span>\n                <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span>obj <span class=\"token keyword\">instanceof</span> <span class=\"token class-name\">ViewModel</span><span class=\"token punctuation\">)</span> obj<span class=\"token punctuation\">.</span><span class=\"token function\">setParent</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">,</span> cat<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> \n            <span class=\"token punctuation\">}</span>\n        <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token comment\">//설명4 ViewModel.notify(this); 제거</span>\n        <span class=\"token comment\">//ViewModel.notify(this);</span>\n        Object<span class=\"token punctuation\">.</span><span class=\"token function\">seal</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> \n    <span class=\"token punctuation\">}</span>\n    <span class=\"token comment\">//설명5 viewModel</span>\n    <span class=\"token function\">viewmodelUpdated</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">updated</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">{</span>updated<span class=\"token punctuation\">.</span><span class=\"token function\">forEach</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">v</span><span class=\"token operator\">=></span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span><span class=\"token function\">add</span><span class=\"token punctuation\">(</span>v<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span><span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<h1 id=\"3-visitor-pattern\" style=\"position:relative;\"><a href=\"#3-visitor-pattern\" aria-label=\"3 visitor pattern permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>3. Visitor Pattern</h1>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token keyword\">const</span> Scanner <span class=\"token operator\">=</span> <span class=\"token keyword\">class</span><span class=\"token punctuation\">{</span>\n    <span class=\"token function\">scan</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">el<span class=\"token punctuation\">,</span> _ <span class=\"token operator\">=</span> <span class=\"token function\">type</span><span class=\"token punctuation\">(</span>el<span class=\"token punctuation\">,</span> HTMLElement<span class=\"token punctuation\">)</span></span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">{</span>\n        <span class=\"token keyword\">const</span> binder <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">Binder</span><span class=\"token punctuation\">;</span>\n        <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span><span class=\"token function\">checkItem</span><span class=\"token punctuation\">(</span>binder<span class=\"token punctuation\">,</span> el<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token keyword\">const</span> stack <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span>el<span class=\"token punctuation\">.</span>firstElementChild<span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span> \n        <span class=\"token keyword\">let</span> target<span class=\"token punctuation\">;</span>\n        <span class=\"token keyword\">while</span><span class=\"token punctuation\">(</span>target <span class=\"token operator\">=</span> stack<span class=\"token punctuation\">.</span><span class=\"token function\">pop</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">{</span>\n            <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span><span class=\"token function\">checkItem</span><span class=\"token punctuation\">(</span>binder<span class=\"token punctuation\">,</span> target<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n            <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span>target<span class=\"token punctuation\">.</span>firstElementChild<span class=\"token punctuation\">)</span> stack<span class=\"token punctuation\">.</span><span class=\"token function\">push</span><span class=\"token punctuation\">(</span>target<span class=\"token punctuation\">.</span>firstElementChild<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> \n            <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span>target<span class=\"token punctuation\">.</span>nextElementSibling<span class=\"token punctuation\">)</span> stack<span class=\"token punctuation\">.</span><span class=\"token function\">push</span><span class=\"token punctuation\">(</span>target<span class=\"token punctuation\">.</span>nextElementSibling<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token punctuation\">}</span>\n        <span class=\"token keyword\">return</span> binder<span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n    <span class=\"token function\">checkItem</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">binder<span class=\"token punctuation\">,</span> el</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">{</span>\n        <span class=\"token keyword\">const</span> vm <span class=\"token operator\">=</span> el<span class=\"token punctuation\">.</span><span class=\"token function\">getAttribute</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"data-viewmodel\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> \n        <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span>vm<span class=\"token punctuation\">)</span> binder<span class=\"token punctuation\">.</span><span class=\"token function\">add</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">new</span> <span class=\"token class-name\">BinderItem</span><span class=\"token punctuation\">(</span>el<span class=\"token punctuation\">,</span> vm<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span> \n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span></code></pre></div>\n<h1 id=\"4-추상계층-불일치\" style=\"position:relative;\"><a href=\"#4-%EC%B6%94%EC%83%81%EA%B3%84%EC%B8%B5-%EB%B6%88%EC%9D%BC%EC%B9%98\" aria-label=\"4 추상계층 불일치 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>4. 추상계층 불일치</h1>\n<h1 id=\"5-설계-종합\" style=\"position:relative;\"><a href=\"#5-%EC%84%A4%EA%B3%84-%EC%A2%85%ED%95%A9\" aria-label=\"5 설계 종합 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>5. 설계 종합</h1>\n<h1 id=\"6\" style=\"position:relative;\"><a href=\"#6\" aria-label=\"6 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>6.</h1>","excerpt":"TODO   class diagram…","tableOfContents":"<ul>\n<li><a href=\"/OOPWithJavascript_4/#todo\">TODO</a></li>\n<li>\n<p><a href=\"/OOPWithJavascript_4/#1-isp\">1. ISP</a></p>\n<ul>\n<li><a href=\"/OOPWithJavascript_4/#11-%EC%98%B5%EC%A0%80%EB%B2%84-%EC%84%9C%EB%B8%8C%EC%A0%9D%ED%8A%B8-%ED%8C%8C%EC%9D%BC-%EB%A6%AC%ED%8C%A9%ED%86%A0%EB%A7%81-%ED%95%98%EA%B8%B0\">1.1 옵저버 서브젝트 파일 리팩토링 하기</a></li>\n<li><a href=\"/OOPWithJavascript_4/#12-notify-%EB%A6%AC%ED%8C%A9%ED%86%A0%EB%A7%81\">1.2 notify 리팩토링</a></li>\n</ul>\n</li>\n<li><a href=\"/OOPWithJavascript_4/#2-%EC%84%AC%EC%84%B8%ED%95%9C-%EA%B6%8C%ED%95%9C-%EC%A1%B0%EC%A0%95\">2. 섬세한 권한 조정</a></li>\n<li><a href=\"/OOPWithJavascript_4/#3-visitor-pattern\">3. Visitor Pattern</a></li>\n<li><a href=\"/OOPWithJavascript_4/#4-%EC%B6%94%EC%83%81%EA%B3%84%EC%B8%B5-%EB%B6%88%EC%9D%BC%EC%B9%98\">4. 추상계층 불일치</a></li>\n<li><a href=\"/OOPWithJavascript_4/#5-%EC%84%A4%EA%B3%84-%EC%A2%85%ED%95%A9\">5. 설계 종합</a></li>\n<li><a href=\"/OOPWithJavascript_4/#6\">6.</a></li>\n</ul>","fields":{"slug":"/OOPWithJavascript_4/"},"frontmatter":{"title":"객체지향 자바스크립트 4회차(MVVM pattern 개선2)","date":"Mar 15, 2020","tags":["코드스피츠","객제지향 자바스크립트"],"keywords":["객체지향","MVVM"]}}},"pageContext":{"slug":"/OOPWithJavascript_4/","series":[{"slug":"/OOPWithJavascript_1/","title":"객체지향 자바스크립트 1회차(객체지향이란? with design Pattern)","num":1},{"slug":"/OOPWithJavascript_2/","title":"객체지향 자바스크립트 2회차(MVVM 구현)","num":2},{"slug":"/OOPWithJavascript_3/","title":"객체지향 자바스크립트 3회차(MVVM pattern 개선)","num":3},{"slug":"/OOPWithJavascript_4/","title":"객체지향 자바스크립트 4회차(MVVM pattern 개선2)","num":4}]}}}